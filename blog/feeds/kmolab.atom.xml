<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>mde.tw/lab 網誌 - KMOLab</title><link href="./" rel="alternate"></link><link href="./feeds/kmolab.atom.xml" rel="self"></link><id>./</id><updated>2021-07-08T12:00:00+08:00</updated><entry><title>cmsimde 修改</title><link href="./2021-kmol-cmsimde-modification.html" rel="alternate"></link><published>2021-07-08T12:00:00+08:00</published><updated>2021-07-08T12:00:00+08:00</updated><author><name>yen</name></author><id>tag:None,2021-07-08:./2021-kmol-cmsimde-modification.html</id><summary type="html">&lt;p&gt;過去使用 &lt;a href="https://www.cmsimple.org/"&gt;CMSimple&lt;/a&gt; 與 &lt;a href="https://www.cmsimple-xh.org/"&gt;CMSimple XH&lt;/a&gt; 當作網際內容管理系統好長一段時間, 主要看重的是它不需要資料庫系統, 只利用 Ｈ1, H2 與 H3 等三個 html 標註進行分頁, 架構非常簡單. 之後用 Python 與 &lt;a href="https://github.com/cherrypy/cherrypy"&gt;CherryPy&lt;/a&gt; 改寫後, 又用了一陣子, 直到框架換成 &lt;a href="https://flask.palletsprojects.com/en/2.0.x/"&gt;Flask&lt;/a&gt;, 並且納入 [Pelican] Blog 與 &lt;a href="https://revealjs.com/"&gt;Reveal.js&lt;/a&gt; 後, 改為目前的 &lt;a href="https://github.com/mdecourse/cmsimde"&gt;cmsimde&lt;/a&gt;.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;過去使用 &lt;a href="https://www.cmsimple.org/"&gt;CMSimple&lt;/a&gt; 與 &lt;a href="https://www.cmsimple-xh.org/"&gt;CMSimple XH&lt;/a&gt; 當作網際內容管理系統好長一段時間, 主要看重的是它不需要資料庫系統, 只利用 Ｈ1, H2 與 H3 等三個 html 標註進行分頁, 架構非常簡單. 之後用 Python 與 &lt;a href="https://github.com/cherrypy/cherrypy"&gt;CherryPy&lt;/a&gt; 改寫後, 又用了一陣子, 直到框架換成 &lt;a href="https://flask.palletsprojects.com/en/2.0.x/"&gt;Flask&lt;/a&gt;, 並且納入 [Pelican] Blog 與 &lt;a href="https://revealjs.com/"&gt;Reveal.js&lt;/a&gt; 後, 改為目前的 &lt;a href="https://github.com/mdecourse/cmsimde"&gt;cmsimde&lt;/a&gt;.&lt;/p&gt;


&lt;h2&gt;與 bug 共存&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://github.com/mdecourse/cmsimde"&gt;cmsimde&lt;/a&gt; 中採用 Tinymce 4.X 作為網際編輯器, 目前雖然已經修改為能夠與 IPv6 網際環境相容, 但是其中的 plugin 已經與最新的 Tinymce 5.X 不相容, 亦即, 假如這些 Javascript 套件發生問題, 就必須自己動手修改. 已經沒有官方原始碼或 cdn 可以引用. 但由於當年所使用的 Javascript, 有些是 minimized 過的版本, 所以某些情況下, 無法進入修正的部分, 就必須設法與 bug 共存.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/mdecourse/cmsimde"&gt;cmsimde&lt;/a&gt; 是在 2013 年 Fall, 一行一行從無到有刻出來的, 照理說每一個程式功能都可以任意修改, 但在今天想要讓三個倉儲的動態網頁同時利用不同的埠號開啟, 卻吃了閉門羹. 該不會這裡又存在另外一個 bug.&lt;/p&gt;
&lt;h2&gt;確實沒有完全弄清楚&lt;/h2&gt;
&lt;p&gt;經常掛在嘴邊的是: 對技術越熟的所謂專家, 其實大多都是非常謙虛的. 因為每天幾乎都碰到許多暫時無解的問題. 何況現在科技日新月異, 真相撲朔迷離, 而且網路上的垃圾比有用的資料多上許多, 因此各行業所謂專家的有效期都非常短. 不管上不上台唱歌, 稍有不慎, 就會從神壇跌落.&lt;/p&gt;
&lt;p&gt;好了, &lt;a href="https://github.com/mdecourse/cmsimde"&gt;cmsimde&lt;/a&gt; 在今天改版之前, 只要同時在一個瀏覽器上啟動兩個以上的動態網頁, 其中一個網站的登入狀態, 會因為另外一個不同埠號的 &lt;a href="https://github.com/mdecourse/cmsimde"&gt;cmsimde&lt;/a&gt; 登入而退出. 追查原因, 是瀏覽器中名稱為 session 的 cookie 值改變, 讓其先前已經登入的  &lt;a href="https://github.com/mdecourse/cmsimde"&gt;cmsimde&lt;/a&gt; 因近端的登入 cookie 值改變而自動 logout.&lt;/p&gt;
&lt;p&gt;第一個想到的是, 在近端與遠端同一端的情況下, 會不會只要將登入後對應 session 的 key 附加一個隨機字串, 或可達到多 &lt;a href="https://github.com/mdecourse/cmsimde"&gt;cmsimde&lt;/a&gt; 同時登入編輯模式的目標. 但是, 卻行不通. 無論如何更改 key 的值, 仍然第二套動態 &lt;a href="https://github.com/mdecourse/cmsimde"&gt;cmsimde&lt;/a&gt; 登入, 該 session 值就會變更, 導致同時只能一套 &lt;a href="https://github.com/mdecourse/cmsimde"&gt;cmsimde&lt;/a&gt; 保持在登入狀態.&lt;/p&gt;
&lt;h2&gt;session 與 cookie 的實況&lt;/h2&gt;
&lt;p&gt;為了設法達到上述多個 &lt;a href="https://github.com/mdecourse/cmsimde"&gt;cmsimde&lt;/a&gt; 可以同時保持登入狀態的功能, 只能重新讀了 &lt;a href="https://www.valentinog.com/blog/cookies/"&gt;re-introduction to HTTP-cookie&lt;/a&gt; 以及 &lt;a href="https://flask.palletsprojects.com/en/2.0.x/"&gt;Flask&lt;/a&gt; 原始碼. 想要找到這個名稱為 session 的 cookie 到底從何而來.&lt;/p&gt;
&lt;p&gt;終於在 &lt;a href="https://leoeditor.com/"&gt;Leo Editor&lt;/a&gt; recursive importer 的協助下, 找到 &lt;a href="https://github.com/pallets/flask/blob/7a73171edc3bcffef96ef6367977ab3ae9af9350/src/flask/app.py#L335"&gt;Flask app.py 第 335 行&lt;/a&gt; 中確實有個名稱為 session 的 cookie. 接下來則是要找看看, 到底這個  cookie 是如何設定.&lt;/p&gt;
&lt;p&gt;而 &lt;a href="https://leoeditor.com/"&gt;Leo Editor&lt;/a&gt; 中的 recursive importer 是這樣寫的:&lt;/p&gt;
&lt;pre class="brush: python"&gt;
'''Recursively import all python files in a directory and clean the result.'''

c.recursiveImport(
    dir_ = r'./',
    kind = '@clean', # The new best practice.
    safe_at_file = True,
    theTypes = ['.py']
)
&lt;/pre&gt;

&lt;p&gt;搜尋 Flask 程式碼, 也可以發現 &lt;a href="https://github.com/pallets/flask/blob/7a73171edc3bcffef96ef6367977ab3ae9af9350/src/flask/sessions.py#L98"&gt;Flask session.py 第 98 行&lt;/a&gt; 明確寫著, 假如沒有設定 secret_key, 網際系統的 session 就無法產生. 從 &lt;a href="https://github.com/pallets/flask/blob/7a73171edc3bcffef96ef6367977ab3ae9af9350/src/flask/sessions.py#L353"&gt;Flask session.py 第 353 行&lt;/a&gt; 也可以發現 session 的值來自 get_signing_serializer(app), 而 &lt;a href="https://github.com/pallets/flask/blob/7a73171edc3bcffef96ef6367977ab3ae9af9350/src/flask/sessions.py#L335"&gt;Flask session.py 第 335 行&lt;/a&gt; 則清楚標示, 原來 cookie key 為 session 的 value 取決於 secret_key.&lt;/p&gt;
&lt;p&gt;經過上述的搜尋, 只要將 cmsimde 的 secret_key 在近端需要同時開啟多個動態網頁時, 給予定值, 就可以達到目的. 但是若在遠端執行時, 則仍必須回復動態值如下, 以保障伺服器與客戶端資料傳輸的安全性.&lt;/p&gt;
&lt;pre class="brush: python"&gt;
secret_key = os.urandom(24).hex()
app.secret_key = secret_key
&lt;/pre&gt;</content><category term="KMOLab"></category><category term="202107"></category></entry><entry><title>2021 Spring</title><link href="./2021-kmol-2021-spring.html" rel="alternate"></link><published>2021-07-08T11:00:00+08:00</published><updated>2021-07-08T11:00:00+08:00</updated><author><name>yen</name></author><id>tag:None,2021-07-08:./2021-kmol-2021-spring.html</id><summary type="html">&lt;p&gt;2021 年 5 月中開始, 由於疫情緊張, 台灣各大學陸續課程宣布採線上教學, 當時正是 W13 開端, 距離 Spring 學期結束, 還有六週.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;2021 年 5 月中開始, 由於疫情緊張, 台灣各大學陸續課程宣布採線上教學, 當時正是 W13 開端, 距離 Spring 學期結束, 還有六週.&lt;/p&gt;


&lt;h2&gt;疫情帶來的考驗&lt;/h2&gt;
&lt;p&gt;當時, Github 與 Gitlab 正遭到數位挖礦者的濫用, 而大舉透過程式 flag 許多上課用戶, 因為多年來大一上課第一週, 都會要求學生以學號當作帳號, 申請 Github account, 沒想到因此讓查驗程式誤判為一人申請多帳號, 而遭到禁用.&lt;/p&gt;
&lt;p&gt;由於 &lt;a href="https://mde.tw"&gt;KMOLab&lt;/a&gt; 所有的課程都能全部在線上進行, 課程也沒有考試, 評量主要依據來自學員 Github 提交歷程, 分組專題貢獻度, 以及參考同儕互評. 因此即便突然由實體上課轉為線上, 就授課的部分而言, 沒有任何問題.&lt;/p&gt;
&lt;p&gt;但是不少學員的 Github 帳號遭 flag, 以及突然讓學生在寄宿地或回到家裡進行線上課程, 就會是一個大問題. 因為實體上課, 每週會有 3-4 堂課在綜合第一工程館八樓的電腦輔助設計室上課, 每個學生都有相同的電腦硬體與網路環境, 無論是執行倉儲改版, 程式編寫, 或者機電系統的配置與控制, 學習機會與環境均等, 但貿然將實體課程轉為線上, 每位學員實際的電腦硬體與網路環境的情況都不相同, 這時課程的評量就面臨考驗.&lt;/p&gt;
&lt;h2&gt;緊急因應&lt;/h2&gt;
&lt;p&gt;2020 年的台灣是全球防疫優等生, 但是潛藏在每個角落的失心, 在疫情緊急下, 問題一一浮現.  其實去年 Spring, 前後就有三個禮拜, &lt;a href="https://mde.tw"&gt;KMOLab&lt;/a&gt; 就已經實施線上課程的演練, 當時就特別要求每位同學要同時申請 Github, Gitlab 與 Heroku 帳號, 而且也告知每一位學員必須要徹底了解家裡或住宿地的網路連線情況, 必須要準備堪用的電腦麥克風與 webcam, 可能的話也要爭取學校宿舍網路的使用環境, 能與電腦輔助設計室相同, 使用純 IPv6 上網, 而且能正確擷取所需使用軟體套件的網路授權, 其中包含學校必須提供 IPv6 協定下的 Windows 10 認證. 但時至今日, 這樣的基本要求仍無法達成.&lt;/p&gt;
&lt;p&gt;於是, 就想起大約十年前, 曾經提出每年擁有超過 500 名新生入學的工學院, 若能在入學階段就輔導學員, “配發"一台堪用四年的筆電, 其中安裝各階段課程會使用到的軟體套件, 如此各電腦教室只需要少量的伺服器與拆機測試用的桌機與筆電, 剩下來的就只要將學校的網路環境安裝與配置, 設法推廣到宿舍與外部學生寄宿地, 所謂的數位延伸校園一旦成形, 後續許多課程內外事務的推動, 將可事半功倍......&lt;/p&gt;
&lt;p&gt;當然, 這樣的夢想早就落空, 每一屆的新生每年都還是問: 要不要買電腦? 買什麼電腦? 筆電還是桌機? 要不要事先安裝什麼 XX 軟體......&lt;/p&gt;
&lt;h2&gt;疫情下的教育&lt;/h2&gt;
&lt;p&gt;2021 年不只經常被笑是紙紮屋的 X 國, 整棟大樓會應聲倒下, 幾乎每位歷任總統都下獄的 X 韓也會, 世界強國的渡假區海邊, 蓋在濕地上的大樓, 也無法倖免. 世界各地一個月前的旱災, 轉眼就可能變成水災......&lt;/p&gt;
&lt;p&gt;假如稍有年紀的世代, 看到許多國家年輕一輩視疫情如無物, 終日把飲料盡歡, 其實也無需過度苛責, 因為大家在全球情勢彼此牽動, 大自然反撲, 貧富如此懸殊的社會, 能夠順心過完一天, 就應該算是幸福的. &lt;/p&gt;
&lt;p&gt;年長一輩的頂多只能勸說, 希望大家能夠設身處地, 互相換位思考, 在群體中的任何一個份子, 都應該有當負起的責任, 其中包括掃下不稱職的民意代表與制度. 並且勇於解決問題, 因為歷史上從來就不會有當權者願意主動放棄既得利益, 疫情下的教育, 是教會年輕的世代, 要積極爭取屬於自己的權益.&lt;/p&gt;</content><category term="KMOLab"></category><category term="202107"></category></entry></feed>